<?xml version="1.0" encoding="UTF-8"?>

<!--pretext-->
    <!--article xml:id="notes"-->
        <section xml:id="LaplaceSolving">
        <title>Solution Technique 7: Solving ODEs with the Laplace Transform</title>
        <p>
            This note tells us the basic method of solving linear constant-coefficient initial value problems using the Laplace transform. 
        </p>
  <p>
    Solving a constant coefficient linear ODE using the Laplace transform and the inverse Laplace transform is best summarized with the following diagram.
  </p>  

 <image>

<prefigure label = "LaplaceDiagram" xmlns="https://prefigure.org">
<diagram dimensions="(300, 300)" margins="(50,5,50,5)">
  <coordinates bbox="(-5,-2,7,5)">
    <definition>p1=(0,4)</definition>
    <definition>p2=(3,4)</definition>
    <definition>p3=(0,0)</definition>
    <definition>p4=(3,0)</definition>

    <line endpoints="(p1,p2)" endpoint-offsets="((5,0), (-5,0))" dash="8 8" arrows="1"/>
    <label p="p1" clear-background="yes" alignment="west">ODE</label>
    <label p="p2" clear-background="yes" alignment="east">Solution in <m>t</m></label>

    <line endpoints="(p3,p4)" endpoint-offsets="((10,0), (-5,0))" arrows="1"/>
    <label p="(1,0)" clear-background="yes" alignment="west">Alegbraic Equation</label>
    <label p="p4" clear-background="yes" alignment="east">Solution in <m>s</m></label>
    <line endpoints="(p1,p3)" endpoint-offsets="((-10,-10), (-10,10))" arrows="1"/>
    <line endpoints="(p4,p2)" endpoint-offsets="((10,10), (10,-15))" arrows="1"/>
    <label p="(-1,2)" clear-background="yes" alignment="west"><m>\mathscr{L}</m></label>
    <label p="(4,2)" clear-background="yes" alignment="east"><m>\mathscr{L}^{-1}</m></label>
    <label p="p2" clear-background="yes" alignment="east">Solution in <m>t</m></label>
    <label p="(.2,2)" clear-background="yes" rotate="90" >"easy"</label>
    <label p="(2.8,2)" clear-background="yes" rotate="90" >"easy"</label>
    <label p="(1,-.5)" clear-background="yes" alignment="east">easy</label>
    <label p="(1.3,4.1)" clear-background="yes" alignment="north">hard</label>
  </coordinates>
</diagram>
</prefigure>
</image>

<p>
  To elaborate on this diagram, we have the following:
</p>

        <algorithm xml:id="Laplace-solving">
            <title>Solving with the Laplace Transform</title>
            <p>
                To solve linear constant-coefficient ODEs using the Laplace transform, proceed as follows:
            <ol>
                <li>
                    <p>
                        Find the Laplace transform of both sides of the equation. Use the rule
                        <me>
                          \mathscr{L}\{y'\}(s) = sY(s) - y(0),
                        </me>
                        or its higher-order version, to get an equation involving <m>Y(s)</m> and <m>s</m>. You will likely need to use <xref ref="LaplaceTable"/>.
                    </p>
                </li>
                <li>
                    <p>
                      Solve the equation you just found explicitly for <m>Y(s)</m>.
                    </p>
                </li>
                <li>
                  <p>
                    Find <m>y(t) = \mathscr{L}^{-1}\{Y\}(t)</m>. You will need to reverse rules from <xref ref="LaplaceTable"/> and often you will use the partial fraction decomposition (see <xref ref="sage-python-partial-fractions"/>). That's it, you're done.
                  </p>
                </li>
            </ol>
            </p>
        </algorithm>

                <table xml:id="LaplaceTable">
            <title>A Short Table of Laplace Transforms</title>
            <tabular>
                <row header="yes">
                    <cell><m>f(t)</m></cell> <cell><m>F(s) = \mathscr{L}\{f\}(s)</m></cell>
                </row>
                <row>
                    <cell>1. <m>t^n</m></cell> <cell><m>\dfrac{n!}{s^{n+1}}</m></cell>
                </row>
                <row>
                    <cell>2. <m>e^{at}</m></cell> <cell><m>\dfrac{1}{s-a}</m></cell>
                </row>
                <row>
                    <cell>3. <m>\cos(\omega t)</m></cell> <cell><m>\dfrac{s}{s^2 + \omega^2}</m></cell>
                </row>
                <row>
                    <cell>4. <m>\sin(\omega t)</m></cell> <cell><m>\dfrac{\omega}{s^2 + \omega^2}</m></cell>
                </row>
                <row>
                    <cell>5. <m>t\cos(\omega t)</m></cell> <cell><m>\dfrac{s^2-\omega^2}{(s^2 + \omega^2)^2}</m></cell>
                </row>
                <row>
                    <cell>6. <m>t\sin(\omega t)</m></cell> <cell><m>\dfrac{2\omega s}{(s^2 + \omega^2)^2}</m></cell>
                </row>
                
                <row>
                    <cell>7. <m>e^{at}f(t)</m></cell> <cell><m>F(s-a)</m></cell>
                </row>
                <row>
                    <cell>8. <m>h(t-a)f(t-a)</m></cell> <cell><m>e^{-as}F(s)</m></cell>
                </row>
                <row>
                    <cell>9. <m>f'(t)</m></cell> <cell><m>sF(s) - f(0)</m></cell>
                </row>
                <row>
                    <cell>10. <m>f''(t)</m></cell> <cell><m>s^2F(s) - sf(0) - f'(0)</m></cell>
                </row>

                <row>
                    <cell>11. <m>\delta(t-a)</m></cell> <cell><m>e^{-as}</m></cell>
                </row>
                <row>
                    <cell>12. <m>(f\ast g)(t)</m></cell> <cell><m>F(s)G(s)</m></cell>
                </row>

            </tabular>
        </table>

        <figure xml:id="sage-python-partial-fractions">
    <caption>Partial Fractions with Python</caption>
<sage  language="python">
<input>
from sympy import symbols, apart

# Define the variables. Add more than just s if there are additional parameters, like k, w, etc..
s = symbols('s')

# Define the rational function
F = 1/((s**2-1))

# Perform partial fraction decomposition.
partial_fractions = apart(F,s)

print(partial_fractions)
</input>
</sage>
</figure>

<p>
  Here are a few notes about <xref ref="LaplaceTable"/>. Each item we refer to below is defined in class.
</p>
<ul>
  <li>
    <p>
      <m>h(t)</m> denotes the Heaviside (a.k.a. unit) step function.
    </p>
  </li>
  <li>
    <p>
      <m>\delta(t)</m> denotes the <m>\delta</m> "function".
    </p>
  </li>
  <li>
    <p>
      <m>f\ast g</m> is the convolution of <m>f</m> with <m>g</m>.
    </p>
  </li>
</ul>


        </section>
    <!--/article-->
<!--/pretext-->